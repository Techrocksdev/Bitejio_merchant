import{R as y,u as D,a as m,h as w,j as e,D as I,s as S,F as C}from"./index-DA83-y1t.js";import{S as O,H as k}from"./sideBar-D8n15IYi.js";import{S as d}from"./skeleton-CGbwBMH3.js";import{h as p}from"./moment-BLMuvzoS.js";function _(){const{isSidebarHidden:g}=D(),[l,j]=m.useState(1),[c,f]=m.useState(10),[a,o]=m.useState({}),{data:u,isLoading:N,refetch:b}=w({queryKey:["ordersList",l,c],queryFn:async()=>C({page:l,pageSize:c,search:"",userId:"",year:0,month:0,startDate:"",endDate:""}),onError:s=>{console.log(s)}}),h=u?.results?.orders||[],i=Math.ceil(u?.results?.totalPages),x=s=>{s>0&&s<=i&&j(s)},v=async(s,r)=>{const n={orderId:s,status:r};try{const t=await I(n);t.error?S(t.message,"error"):b()}catch{console.log("An error occurred")}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"admin-wrapper d-flex",children:[e.jsx(O,{}),e.jsxs("div",{className:g?"main-content flex-grow-1 full":"main-content flex-grow-1",id:"main-content",children:[e.jsx(k,{}),e.jsxs("main",{className:"p-4",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("div",{className:"d-flex gap-3 align-items-center justify-content-between",children:e.jsx("h3",{className:"fw-semibold fs-5",children:"Order Management"})})}),e.jsx("div",{className:"table-responsive shadow-sm rounded bg-white p-3",children:e.jsxs("table",{className:"table table-hover align-middle",children:[e.jsx("thead",{className:"table-light",children:e.jsxs("tr",{children:[e.jsx("th",{children:"S.No"}),e.jsx("th",{children:"Order ID"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{children:"Items"}),e.jsx("th",{children:"Total"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Date"}),e.jsx("th",{className:"text-center",children:"Actions"})]})}),e.jsx("tbody",{children:N?[...Array(c)].map((s,r)=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx(d,{})}),e.jsx("td",{children:e.jsx(d,{})}),e.jsx("td",{children:e.jsx(d,{})}),e.jsx("td",{children:e.jsx(d,{})}),e.jsx("td",{children:e.jsx(d,{})}),e.jsx("td",{children:e.jsx(d,{})}),e.jsx("td",{children:e.jsx(d,{})}),e.jsx("td",{children:e.jsx(d,{})})]},r)):h?.length?h?.map((s,r)=>e.jsxs("tr",{children:[e.jsx("td",{children:r+1}),e.jsxs("td",{children:["#",s.orderId]}),e.jsx("td",{children:s.userId.firstName}),e.jsx("td",{children:s.products&&s.products.map((n,t)=>e.jsxs("span",{children:[n.quantity,"x"," ",n.productId?.name_en,t<s.products.length-1?", ":""]},n._id||t))}),e.jsxs("td",{children:["₹",s.amount]}),e.jsx("td",{children:e.jsxs("select",{value:s.status,className:"form-select form-select-sm status-dropdown",onChange:n=>v(s._id,n.target.value),children:[e.jsx("option",{value:"Pending",children:"Pending"}),e.jsx("option",{value:"Preparing",selected:!0,children:"Preparing"}),e.jsx("option",{value:"Out for Delivery",children:"Out for Delivery"}),e.jsx("option",{value:"Delivered",children:"Delivered"}),e.jsx("option",{value:"Cancelled",children:"Cancelled"})]})}),e.jsx("td",{children:p(s.createdAt).format("DD MMM YYYY, hh:mm A")}),e.jsx("td",{className:"text-center",children:e.jsx("button",{className:"table-btn bg-main me-2","data-bs-toggle":"modal","data-bs-target":"#viewOrderModal",onClick:()=>o(s),children:e.jsx("i",{className:"fa fa-eye"})})})]},s._id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"text-center",children:"Oops! No Result Found."})})})]})})]}),h?.length?e.jsx("div",{className:"col-md-12 mt-3",children:e.jsxs("div",{className:"row align-items-center justify-content-between",children:[e.jsx("div",{className:"col-auto",children:e.jsxs("div",{className:"datafilter",children:[e.jsx("span",{children:"Showing"}),e.jsxs("select",{className:"form-select","aria-label":"Default select example",value:c,onChange:s=>{f(parseInt(s.target.value,10)),j(1)},children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:15,children:"15"}),e.jsx("option",{value:20,children:"20"})]})]})}),e.jsx("div",{className:"col-auto",children:e.jsx("div",{className:"page_txt"})}),e.jsx("div",{className:"col-auto",children:e.jsx("nav",{"aria-label":"Page navigation example",children:e.jsxs("ul",{className:"pagination border-0 gap-2",children:[e.jsx("li",{className:"page-item",children:e.jsx("button",{className:`page-link ${l===1?"disabled":""}`,onClick:()=>x(l-1),disabled:l===1,children:e.jsx("i",{class:"fa fa-angle-left"})})}),Array.from({length:i}).map((s,r)=>r+1).filter(s=>s===1||s===i||Math.abs(s-l)<=2).reduce((s,r,n,t)=>(n>0&&r-t[n-1]>1&&s.push("..."),s.push(r),s),[]).map((s,r)=>s==="..."?e.jsx("span",{className:"pagination-ellipsis",children:"..."},r):e.jsx(e.Fragment,{children:e.jsx("li",{className:"page-item",children:e.jsx("button",{className:`page-link ${l===s?"active":""}`,onClick:()=>x(s),children:s},r)})})),e.jsx("li",{className:"page-item",children:e.jsx("button",{className:`page-link ${l===i?"disabled":""}`,onClick:()=>x(l+1),disabled:l===i,children:e.jsx("i",{class:"fa fa-angle-right"})})})]})})})]})}):""]})]})]}),e.jsx("div",{className:"modal fade",id:"viewOrderModal",tabIndex:-1,"aria-hidden":"true","data-bs-backdrop":"static",children:e.jsx("div",{className:"modal-dialog modal-dialog-centered modal-lg",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title text-main fw-bold",children:"Order Details"}),e.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal",onClick:()=>o({})})]}),e.jsx("div",{className:"modal-body",children:e.jsxs("div",{className:"row g-4",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsx("h6",{className:"fw-bold text-main mb-2",children:"Customer Details"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Name:"})," ",a?.userId?.firstName," ",a?.userId?.lastName]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," ",a?.userId?.email]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Phone:"})," ",a?.userId?.phoneNumber]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Address:"})," ",e.jsxs("a",{href:`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(`${a?.address?.address_line2} ${a?.address?.address_line1}`)}`,target:"_blank",rel:"noopener noreferrer",style:{color:"#ff6b00",fontWeight:"400",textDecoration:"underline",textUnderlineOffset:"4px"},children:[e.jsx("i",{className:"fas fa-map-marker-alt me-1"}),a?.address?.address_line2," ",a?.address?.address_line1]})]})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("h6",{className:"fw-bold text-main mb-2",children:"Merchant Details"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Shop:"})," ",a?.merchant?.shopName]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Contact:"})," ",a?.merchant?.phoneNumber]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Location:"})," ",a?.merchant?.address]})]}),e.jsxs("div",{className:"col-12",children:[e.jsx("h6",{className:"fw-bold text-main mb-2",children:"Order Information"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Order ID:"})," #",a?.orderId]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Items:"}),a?.products&&a?.products.map((s,r)=>e.jsxs("span",{children:[s.quantity,"x ",s.productId?.name_en,r<a?.products.length-1?", ":""]},s._id||r))]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Total Amount:"})," ₹",a?.amount]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Payment Method:"})," UPI"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"})," ",a?.status]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Placed At:"})," ",p(a.createdAt).format("DD MMM YYYY, hh:mm A")]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Expected Delivery:"})," 1 hour"]})]})]})}),e.jsx("div",{className:"modal-footer",children:e.jsx("button",{className:"btn comman-btn-main",onClick:()=>o({}),"data-bs-dismiss":"modal",children:"Close"})})]})})})]})}const $=y.memo(_);export{$ as default};
