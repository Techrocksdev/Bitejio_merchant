import{R as D,u as I,r as u,b as i,j as e,I as O,s as N,J as C,K as S,M as k,g as M}from"./index-8kXOQ8MA.js";import{S as _,H as A}from"./header-Bd8wBNxd.js";import{S as t}from"./skeleton-4DzpXXu5.js";import{h as f}from"./moment-BLMuvzoS.js";function B(){const{isSidebarHidden:g}=I(),[o,m]=u.useState(""),[a,c]=u.useState({}),{data:n}=i({queryKey:["getDashboardCount"],queryFn:S,onError:s=>{console.log(s)},select:s=>s.results.data}),{data:p,isLoading:v,refetch:h}=i({queryKey:["ordersList"],queryFn:async()=>k({page:1,pageSize:5,search:"",userId:"",year:0,month:0,startDate:"",endDate:""}),onError:s=>{console.log(s)}}),x=p?.results?.orders||[],{data:b}=i({queryKey:["deliveryBoyList"],queryFn:async()=>M({page:1,pageSize:1e3,search:"",from:"",to:"",status:""}),onError:s=>{console.log(s)}}),y=b?.results?.deliveryBoys||[],j=async(s,d)=>{const r={orderId:s,status:d};try{const l=await O(r);l.error?N(l.message,"error"):h()}catch{console.log("An error occurred")}},w=async s=>{const d={orderId:o,userId:s};try{const r=await C(d);r.error?N(r.message,"error"):(document.getElementById("closemodalFordel").click(),h())}catch{console.log("An error occurred")}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"admin-wrapper d-flex",children:[e.jsx(_,{}),e.jsxs("div",{className:g?"main-content flex-grow-1 full":"main-content flex-grow-1",id:"main-content",children:[e.jsx(A,{}),e.jsxs("main",{className:"p-4",children:[e.jsxs("div",{className:"row mb-4 g-3",children:[e.jsx("div",{className:"col-md-3 col-sm-6",children:e.jsxs("div",{className:"card stat-card shadow-sm p-3 d-flex flex-row align-items-center",children:[e.jsx("div",{className:"icon-circle bg-light-main text-main me-3",children:e.jsx("i",{className:"fa-solid fa-box"})}),e.jsxs("div",{className:"text-start",children:[e.jsx("h6",{className:"fw-semibold text-muted mb-1",children:"Total Orders"}),e.jsx("h4",{className:"fw-bold text-dark mb-0",children:n?.orderCount||0})]})]})}),e.jsx("div",{className:"col-md-3 col-sm-6",children:e.jsxs("div",{className:"card stat-card shadow-sm p-3 d-flex flex-row align-items-center",children:[e.jsx("div",{className:"icon-circle me-3",children:e.jsx("i",{className:"fa-solid fa-hourglass-half"})}),e.jsxs("div",{className:"text-start",children:[e.jsx("h6",{className:"fw-semibold text-muted mb-1",children:"Pending Orders"}),e.jsx("h4",{className:"fw-bold text-dark mb-0",children:n?.pendingOrderCount||0})]})]})}),e.jsx("div",{className:"col-md-3 col-sm-6",children:e.jsxs("div",{className:"card stat-card shadow-sm p-3 d-flex flex-row align-items-center",children:[e.jsx("div",{className:"icon-circle me-3",children:e.jsx("i",{className:"fa-solid fa-truck"})}),e.jsxs("div",{className:"text-start",children:[e.jsx("h6",{className:"fw-semibold text-muted mb-1",children:"Delivered Orders"}),e.jsx("h4",{className:"fw-bold text-dark mb-0",children:n?.deliveredOrderCount||0})]})]})}),e.jsx("div",{className:"col-md-3 col-sm-6",children:e.jsxs("div",{className:"card stat-card shadow-sm p-3 d-flex flex-row align-items-center",children:[e.jsx("div",{className:"icon-circle me-3",children:e.jsx("i",{className:"fa-solid fa-indian-rupee-sign"})}),e.jsxs("div",{className:"text-start",children:[e.jsx("h6",{className:"fw-semibold text-muted mb-1",children:"Total Revenue"}),e.jsxs("h4",{className:"fw-bold text-dark mb-0",children:[" ","₹",n?.revenue||0]})]})]})})]}),e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("div",{className:"d-flex gap-3 align-items-center justify-content-between",children:e.jsx("h3",{className:"fw-semibold fs-5",children:"Recent Orders"})})}),e.jsx("div",{className:"table-responsive shadow-sm rounded bg-white p-3",children:e.jsxs("table",{className:"table table-hover align-middle",children:[e.jsx("thead",{className:"table-light",children:e.jsxs("tr",{children:[e.jsx("th",{children:"S.No"}),e.jsx("th",{children:"Order ID"}),e.jsx("th",{children:"Customer"}),e.jsx("th",{children:"Items"}),e.jsx("th",{children:"Total"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Date"}),e.jsx("th",{className:"text-center",children:"Actions"})]})}),e.jsx("tbody",{children:v?[...Array(5)].map((s,d)=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx(t,{})}),e.jsx("td",{children:e.jsx(t,{})}),e.jsx("td",{children:e.jsx(t,{})}),e.jsx("td",{children:e.jsx(t,{})}),e.jsx("td",{children:e.jsx(t,{})}),e.jsx("td",{children:e.jsx(t,{})}),e.jsx("td",{children:e.jsx(t,{})}),e.jsx("td",{children:e.jsx(t,{})})]},d)):x?.length?x?.map((s,d)=>e.jsxs("tr",{children:[e.jsx("td",{children:d+1}),e.jsxs("td",{children:["#",s.orderId]}),e.jsx("td",{children:s.userId.firstName}),e.jsx("td",{children:s.products&&s.products.map((r,l)=>e.jsxs("span",{children:[r.quantity,"x"," ",r.productId?.name_en,l<s.products.length-1?", ":""]},r._id||l))}),e.jsxs("td",{children:["₹",s.amount]}),e.jsx("td",{children:e.jsxs("select",{value:s.status,className:"form-select form-select-sm status-dropdown",onChange:r=>{const l=r.target.value;l==="Out for Delivery"?(document.getElementById("modalFordel")?.click(),m(s._id)):j(s._id,l)},children:[e.jsx("option",{value:"Pending",children:"Pending"}),e.jsx("option",{value:"Preparing",selected:!0,children:"Preparing"}),e.jsx("option",{value:"Out for Delivery",children:"Out for Delivery"}),e.jsx("option",{value:"Delivered",children:"Delivered"}),e.jsx("option",{value:"Cancelled",children:"Cancelled"})]})}),e.jsx("td",{children:f(s.createdAt).format("DD MMM YYYY, hh:mm A")}),e.jsx("td",{className:"text-center",children:e.jsx("button",{className:"table-btn bg-main me-2","data-bs-toggle":"modal","data-bs-target":"#viewOrderModal",onClick:()=>c(s),children:e.jsx("i",{className:"fa fa-eye"})})})]},s._id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"text-center",children:"Oops! No Result Found."})})})]})})]})})})]})]})]}),e.jsx("div",{className:"modal fade",id:"viewOrderModal",tabIndex:-1,"aria-hidden":"true","data-bs-backdrop":"static",children:e.jsx("div",{className:"modal-dialog modal-dialog-centered modal-lg",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title text-main fw-bold",children:"Order Details"}),e.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal",onClick:()=>c({})})]}),e.jsx("div",{className:"modal-body",children:e.jsxs("div",{className:"row g-4",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsx("h6",{className:"fw-bold text-main mb-2",children:"Customer Details"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Name:"})," ",a?.userId?.firstName," ",a?.userId?.lastName]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," ",a?.userId?.email]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Phone:"})," ",a?.userId?.phoneNumber]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Address:"})," ",e.jsxs("a",{href:`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(`${a?.address?.address_line2} ${a?.address?.address_line1}`)}`,target:"_blank",rel:"noopener noreferrer",style:{color:"#ff6b00",fontWeight:"400",textDecoration:"underline",textUnderlineOffset:"4px"},children:[e.jsx("i",{className:"fas fa-map-marker-alt me-1"}),a?.address?.address_line2," ",a?.address?.address_line1]})]})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("h6",{className:"fw-bold text-main mb-2",children:"Merchant Details"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Shop:"})," ",a?.merchant?.shopName]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Contact:"})," ",a?.merchant?.phoneNumber]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Location:"})," ",a?.merchant?.address]})]}),e.jsxs("div",{className:"col-12",children:[e.jsx("h6",{className:"fw-bold text-main mb-2",children:"Order Information"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Order ID:"})," #",a?.orderId]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Items:"})," ",a?.products&&a?.products.map((s,d)=>e.jsxs("span",{children:[s.quantity,"x ",s.productId?.name_en,d<a?.products.length-1?", ":""]},s._id||d))]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Total Amount:"})," ₹",a?.amount]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Payment Method:"})," COD"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"})," ",a?.status]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Placed At:"})," ",f(a.createdAt).format("DD MMM YYYY, hh:mm A")]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Expected Delivery:"})," 30 Minutes"]})]})]})}),e.jsx("div",{className:"modal-footer",children:e.jsx("button",{className:"btn comman-btn-main",onClick:()=>c({}),"data-bs-dismiss":"modal",children:"Close"})})]})})}),e.jsx("div",{className:"modal fade",id:"viewDelBoyModal",tabIndex:-1,"aria-hidden":"true","data-bs-backdrop":"static",children:e.jsx("div",{className:"modal-dialog modal-dialog-centered",children:e.jsxs("div",{className:"modal-content",children:[e.jsx("div",{className:"modal-header",children:e.jsx("h5",{className:"modal-title text-main fw-bold",children:"Delivery Boy"})}),e.jsx("div",{className:"modal-body",children:e.jsx("div",{className:"col-md-12",children:e.jsxs("select",{className:"form-control form-select",id:"actionSelect",onChange:s=>{j(o,"Out for Delivery"),w(s.target.value)},children:[e.jsx("option",{hidden:!0,value:"",children:"Select Delivery Boy"}),y.map(s=>e.jsxs("option",{value:s._id,children:[s.firstName," ",s.lastName]},s._id))]})})}),e.jsx("div",{className:"modal-footer",children:e.jsx("button",{className:"btn comman-btn-main",id:"closemodalFordel","data-bs-dismiss":"modal",onClick:()=>{m(""),document.getElementById("actionSelect").value=""},children:"Close"})})]})})}),e.jsx("div",{className:"d-none",id:"modalFordel","data-bs-toggle":"modal","data-bs-target":"#viewDelBoyModal"})]})}const Y=D.memo(B);export{Y as default};
