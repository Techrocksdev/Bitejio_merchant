import{R as w,r as h,j as e,e as S,a as A,s as N,u as M,b as L,L as D,c as E,d as F,g as $}from"./index-S6-I6USK.js";import{S as B,H as q}from"./header-B8u4Ziyx.js";import{S as j}from"./skeleton-2Xj4wYJM.js";import{u as I,C as P,F as _}from"./index-Dz1OxvFt.js";import{P as Z}from"./style-CM3BQ8m_.js";function z({details:r,setDetails:n,refetch:b,setCurrentPage:x}){const{register:o,handleSubmit:d,control:m,formState:{errors:t},reset:p,setValue:c}=I({mode:"onChange"}),[f,u]=h.useState(!1);h.useEffect(()=>{if(r?.firstName){if(c("firstName",r?.firstName),c("lastName",r?.lastName),c("address",r?.address),c("email",r?.email),r?.phoneNumber){const l=r?.phoneNumber.replace(/^\+/,""),i=`${r?.countryCode}`;c("phoneNumber",{phoneNumber:l,countryCode:i})}c("status",r?.status)}else p()},[r]);const g=async l=>{u(!0),l.countryCode=l.phoneNumber.countryCode,l.phoneNumber=l.phoneNumber.phoneNumber,r?.firstName&&(l.userId=r._id);try{const i=r?.firstName?await S(l):await A(l);i.error?N(i.message,"error"):(N(i.message,"success"),x(1),await b(),document.getElementById("closeAddMerchantModal").click())}catch{console.log("An error occurred")}finally{u(!1)}};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("h5",{className:"modal-title text-main fw-bold",children:[r?.firstName?"Edit":"Add"," Delivery Boy"]}),e.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",id:"closeAddMerchantModal",onClick:()=>{p(),n({})}})]}),e.jsxs("form",{onSubmit:d(g),children:[e.jsxs("div",{className:"modal-body row g-3",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsxs("label",{className:"form-label fw-semibold",children:["First Name ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"text",className:`form-control ${t.firstName?"input-error":""}`,placeholder:"Enter first name",...o("firstName",{required:"First name is required",minLength:{value:2,message:"First name must be at least 2 characters"},maxLength:{value:50,message:"First name must be less than 50 characters"},pattern:{value:/^[A-Za-z\s]+$/,message:"First name can only contain letters and spaces"}})}),t.firstName&&e.jsx("p",{className:"form-error",children:t.firstName.message})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsxs("label",{className:"form-label fw-semibold",children:["Last Name ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"text",className:`form-control ${t.lastName?"input-error":""}`,placeholder:"Enter last name",...o("lastName",{required:"Last name is required",minLength:{value:2,message:"Last name must be at least 2 characters"},maxLength:{value:50,message:"Last name must be less than 50 characters"},pattern:{value:/^[A-Za-z\s]+$/,message:"Last name can only contain letters and spaces"}})}),t.lastName&&e.jsx("p",{className:"form-error",children:t.lastName.message})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsxs("label",{className:"form-label fw-semibold",children:["Email ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"email",className:`form-control ${t.email?"input-error":""}`,placeholder:"Enter email address",...o("email",{required:"Email is required",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Invalid email address"}}),readOnly:!!r?.firstName}),t.email&&e.jsx("p",{className:"form-error",children:t.email.message})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsxs("label",{className:"form-label fw-semibold",children:["Phone Number ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx(P,{className:`form-control ${t.phoneNumber?"input-error":""}`,name:"phoneNumber",control:m,rules:{required:"Phone number is required"},render:({field:l})=>e.jsx(Z,{country:"in",inputClass:`form-control ${t.phoneNumber?"input-error":""}`,inputStyle:{padding:"unset",paddingLeft:"48px"},value:l?.value?.phoneNumber?`${l?.value?.countryCode}${l?.value?.phoneNumber}`:"",onChange:(i,v)=>{const C=i.slice(v.dialCode.length);l.onChange({phoneNumber:C,countryCode:`+${v.dialCode}`})}})}),t.phoneNumber&&e.jsx("p",{className:"form-error",children:t.phoneNumber.message})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsxs("label",{className:"form-label fw-semibold",children:["Address ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsx("input",{type:"text",className:`form-control ${t.address?"input-error":""}`,placeholder:"Enter address",...o("address",{required:"Address is required"})}),t.address&&e.jsx("p",{className:"form-error",children:t.address.message})]}),e.jsxs("div",{className:"col-md-6 d-flex align-items-center",children:[e.jsx("label",{className:"form-label fw-semibold me-3",children:"Status"}),e.jsx("div",{className:"form-check form-switch",children:e.jsx("input",{className:"form-check-input",type:"checkbox",defaultChecked:r?.firstName?"":!0,...o("status")})})]})]}),e.jsx("div",{className:"modal-footer",children:e.jsx("button",{type:"submit",className:"btn comman-btn-main",disabled:f,children:f?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"me-2",children:"Saving..."}),e.jsx(_,{strokeColor:"white",strokeWidth:"5",animationDuration:"0.75",width:"20",visible:!0})]}):r?.firstName?"Edit":"Save"})})]})]})})}const R=w.memo(z);function H(){const{isSidebarHidden:r}=M(),[n,b]=h.useState(1),[x,o]=h.useState(10),[d,m]=h.useState({}),[t,p]=h.useState("");h.useEffect(()=>{},[d]);const{data:c,isLoading:f,refetch:u}=L({queryKey:["deliveryBoyList",n,x],queryFn:async()=>$({page:n,pageSize:x,search:"",from:"",to:"",status:""}),onError:s=>{console.log(s)}}),g=c?.results?.deliveryBoys||[],l=Math.ceil(c?.results?.totalPages),i=s=>{s>0&&s<=l&&b(s)},v=async s=>{try{const a=await E(s);a.error?N(a.message,"error"):(N(a.message,"success"),u())}catch{console.log("An error occurred")}},C=async s=>{try{const a=await F(s);a.error?N(a.message,"error"):(N(a.message,"success"),document.getElementById("close").click(),u())}catch{console.log("An error occurred")}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"admin-wrapper d-flex",children:[e.jsx(B,{}),e.jsxs("div",{className:r?"main-content flex-grow-1 full":"main-content flex-grow-1",id:"main-content",children:[e.jsx(q,{}),e.jsxs("main",{className:"p-4",children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("div",{className:"d-flex gap-3 align-items-center justify-content-between",children:[e.jsx("h3",{className:"fw-semibold fs-5",children:"Delivery Boy Management"}),e.jsxs("button",{className:"btn btn-sm btn-light w-auto","data-bs-toggle":"modal","data-bs-target":"#addMerchantModal",children:[e.jsx("i",{className:"fa fa-plus me-1"})," Add"]})]})}),e.jsx("div",{className:"table-responsive shadow-sm rounded bg-white p-3",children:e.jsxs("table",{className:"table table-hover align-middle",children:[e.jsx("thead",{className:"table-light",children:e.jsxs("tr",{children:[e.jsx("th",{children:"S.No"}),e.jsx("th",{children:"First Name"}),e.jsx("th",{children:"Last Name"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Status"}),e.jsx("th",{className:"text-center",children:"Actions"})]})}),e.jsx("tbody",{children:f?[...Array(x)].map((s,a)=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx(j,{})}),e.jsx("td",{children:e.jsx(j,{})}),e.jsx("td",{children:e.jsx(j,{})}),e.jsx("td",{children:e.jsx(j,{})}),e.jsx("td",{children:e.jsx(j,{})}),e.jsx("td",{children:e.jsx(j,{})})]},a)):g?.length?g?.map((s,a)=>e.jsxs("tr",{children:[e.jsx("td",{children:a+1}),e.jsx("td",{children:s.firstName}),e.jsx("td",{children:s.lastName}),e.jsx("td",{children:s.email}),e.jsx("td",{children:e.jsx("div",{className:"form-check form-switch",children:e.jsx("input",{className:"form-check-input",type:"checkbox",checked:s.status,onChange:()=>v(s._id)})})}),e.jsxs("td",{className:"text-center",children:[e.jsx("button",{className:"table-btn bg-main me-2","data-bs-toggle":"modal","data-bs-target":"#viewMerchantModal",onClick:()=>m(s),children:e.jsx("i",{className:"fa fa-eye"})}),e.jsx("button",{className:"table-btn bg-main me-2","data-bs-toggle":"modal","data-bs-target":"#addMerchantModal",onClick:()=>m(s),children:e.jsx("i",{className:"fa fa-edit"})}),e.jsx("button",{className:"table-btn bg-danger","data-bs-toggle":"modal","data-bs-target":"#delete",onClick:y=>{y.stopPropagation(),p(s._id)},children:e.jsx("i",{className:"fa fa-trash"})})]})]})):e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center",children:"Oops! No Result Found."})})})]})})]}),g?.length?e.jsx("div",{className:"col-md-12 mt-3",children:e.jsxs("div",{className:"row align-items-center justify-content-between",children:[e.jsx("div",{className:"col-auto",children:e.jsxs("div",{className:"datafilter",children:[e.jsx("span",{children:"Showing"}),e.jsxs("select",{className:"form-select","aria-label":"Default select example",value:x,onChange:s=>{o(parseInt(s.target.value,10)),b(1)},children:[e.jsx("option",{value:"",children:"Select"}),e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:15,children:"15"}),e.jsx("option",{value:20,children:"20"})]})]})}),e.jsx("div",{className:"col-auto",children:e.jsx("div",{className:"page_txt"})}),e.jsx("div",{className:"col-auto",children:e.jsx("nav",{"aria-label":"Page navigation example",children:e.jsxs("ul",{className:"pagination border-0 gap-2",children:[e.jsx("li",{className:"page-item",children:e.jsx("button",{className:`page-link ${n===1?"disabled":""}`,onClick:()=>i(n-1),disabled:n===1,children:e.jsx("i",{class:"fa fa-angle-left"})})}),Array.from({length:l}).map((s,a)=>a+1).filter(s=>s===1||s===l||Math.abs(s-n)<=2).reduce((s,a,y,k)=>(y>0&&a-k[y-1]>1&&s.push("..."),s.push(a),s),[]).map((s,a)=>s==="..."?e.jsx("span",{className:"pagination-ellipsis",children:"..."},a):e.jsx(e.Fragment,{children:e.jsx("li",{className:"page-item",children:e.jsx("button",{className:`page-link ${n===s?"active":""}`,onClick:()=>i(s),children:s},a)})})),e.jsx("li",{className:"page-item",children:e.jsx("button",{className:`page-link ${n===l?"disabled":""}`,onClick:()=>i(n+1),disabled:n===l,children:e.jsx("i",{class:"fa fa-angle-right"})})})]})})})]})}):""]})]})]}),e.jsx("div",{className:"modal fade",id:"viewMerchantModal",tabIndex:-1,"aria-hidden":"true","data-bs-backdrop":"static",children:e.jsx("div",{className:"modal-dialog modal-dialog-centered",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title text-main fw-bold",children:"Delivery Boy Details"}),e.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal",onClick:()=>m({})})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"First Name:"})," ",d?.firstName]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Last Name:"})," ",d?.lastName]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," ",d?.email]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Address:"})," ",d?.address]}),e.jsxs("p",{children:[e.jsx("strong",{children:" Phone Number:"})," ",d?.phoneNumber]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"})," ",d?.status?"Active":"Inactive"]})]}),e.jsx("div",{className:"modal-footer",children:e.jsx("button",{className:"btn comman-btn-main","data-bs-dismiss":"modal",onClick:()=>m({}),children:"Close"})})]})})}),e.jsx("div",{className:"modal fade",id:"addMerchantModal",tabIndex:-1,"aria-hidden":"true","data-bs-backdrop":"static",children:e.jsx("div",{className:"modal-dialog modal-dialog-centered modal-lg",children:e.jsx(R,{details:d,setDetails:m,refetch:u,setCurrentPage:b})})}),e.jsx("div",{className:"modal fade logoutmodal",id:"delete",tabIndex:-1,"aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:e.jsx("div",{className:"modal-dialog modal-dialog-centered",children:e.jsx("div",{className:"modal-content",children:e.jsx("div",{className:"modal-body",children:e.jsxs("div",{className:"paymentmodal_main text-center",children:[e.jsxs("div",{className:"payment_head mb-3 mt-1",children:[e.jsx("h2",{children:"Confirmation"}),e.jsx("p",{children:"Are you sure? This action can not be reverted."})]}),e.jsxs("div",{className:"row justify-content-center mb-2",children:[e.jsx("div",{className:"col-auto",children:e.jsx("button",{className:"comman-btn-main",onClick:()=>C(t),children:"Yes"})}),e.jsx("div",{className:"col-auto",children:e.jsx(D,{className:"comman-btn-main white","data-bs-dismiss":"modal",to:"",onClick:()=>p(""),id:"close",children:"No"})})]})]})})})})})]})}const T=w.memo(H);export{T as default};
