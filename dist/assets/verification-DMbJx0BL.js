import{f as g,j as t,R as j,y as I,d as w,u as E,x as N,s as f,z as T}from"./index-DJa2acDB.js";import{u as B,F as L}from"./index-BixC2D_R.js";const P=({seconds:n=30,minutes:u=0,onResendClick:o,resendButtonText:d="Resend OTP",text:p="Time Left",style:x={},buttonStyle:h={}})=>{const[s,y]=g.useState(u*60+n),[i,l]=g.useState(!0);g.useEffect(()=>{let a;return i&&s>0?a=setInterval(()=>{y(s-1)},1e3):s===0&&l(!1),()=>clearInterval(a)},[i,s]);const v=async()=>{o&&await o()!==!1&&(y(u*60+n),l(!0))},m=()=>{const a=Math.floor(s/60),e=s%60;return`${a}:${e<10?"0":""}${e}`};return t.jsx("div",{style:x,children:i?t.jsxs("span",{children:[p," ",m()]}):t.jsx("button",{onClick:v,style:{background:"none",border:"none",color:"#e46a15",fontWeight:600,fontSize:"16px",cursor:"pointer",...h},children:d})})};function S(){const{register:n,handleSubmit:u,formState:{errors:o}}=B({mode:"onChange"}),[d,p]=g.useState(!1),x=I(),h=w(),{refetch:s}=E(),i=new URLSearchParams(x.search).get("email"),l=i?atob(i):null,v=async e=>{p(!0);let r=Object.values(e);r=r.join("");const b={email:l,otp:r};try{const c=await T(b);c.error?f(c.message,"error"):(x?.state?.type?(localStorage.setItem("token-bit-merchant",c.results.token),s()):h(`/reset-password?email=${btoa(l)}`),f(c.message,"success"))}catch{console.log("An error occurred")}finally{p(!1)}},m=(e,r,b,c)=>{e.keyCode!==9&&(e.key==="ArrowLeft"||e.key==="Backspace"?c?.focus():r?.value?.length>=r.maxLength&&b?.focus())},a=async()=>{const e={email:l};try{const r=await N(e);r.error?f(r.message,"error"):f(`Your OTP is: ${r.results.otp}`,"success")}catch{console.log("An error occurred")}};return t.jsx("div",{className:"d-flex align-items-center justify-content-center vh-100",children:t.jsxs("div",{className:"card shadow p-4 border-0 login-card",children:[t.jsx("h3",{className:"text-center mb-3 text-main fw-bold",children:"Verify OTP"}),t.jsx("p",{className:"text-center text mb-4",children:"Enter the 6-digit OTP sent to your email."}),t.jsxs("form",{onSubmit:u(v),className:"text-center",children:[t.jsxs("div",{className:"d-flex justify-content-center mb-4",children:[t.jsx("input",{type:"number",maxLength:1,className:`form-control text-center mx-1 ${o.otp1?"input-error":""}`,style:{width:"50px",height:"50px"},...n("otp1",{required:!0}),onKeyUp:e=>{m(e,document.getElementById("otp1"),document.getElementById("otp2"))},onInput:e=>{e.target.value.length>1&&(e.target.value=e.target.value.slice(0,1))},id:"otp1"}),t.jsx("input",{type:"number",maxLength:1,className:`form-control text-center mx-1 ${o.otp2?"input-error":""}`,style:{width:"50px",height:"50px"},...n("otp2",{required:!0}),onKeyUp:e=>{m(e,document.getElementById("otp2"),document.getElementById("otp3"),document.getElementById("otp1"))},onInput:e=>{e.target.value.length>1&&(e.target.value=e.target.value.slice(0,1))},id:"otp2"}),t.jsx("input",{type:"number",maxLength:1,className:`form-control text-center mx-1 ${o.otp3?"input-error":""}`,style:{width:"50px",height:"50px"},...n("otp3",{required:!0}),onKeyUp:e=>{m(e,document.getElementById("otp3"),document.getElementById("otp4"),document.getElementById("otp2"))},onInput:e=>{e.target.value.length>1&&(e.target.value=e.target.value.slice(0,1))},id:"otp3"}),t.jsx("input",{type:"number",maxLength:1,className:`form-control text-center mx-1 ${o.otp4?"input-error":""}`,style:{width:"50px",height:"50px"},...n("otp4",{required:!0}),onKeyUp:e=>{m(e,document.getElementById("otp4"),document.getElementById("otp5"),document.getElementById("otp3"))},onInput:e=>{e.target.value.length>1&&(e.target.value=e.target.value.slice(0,1))},id:"otp4"})]}),t.jsx("div",{className:"mt-3 mb-3 text",children:t.jsx(P,{seconds:30,onResendClick:a,resendButtonText:"Resend OTP",text:"Time Left: ",style:{fontSize:"14px",textAlign:"center"}})}),t.jsx("button",{type:"submit",className:"btn w-100 comman-btn-main ",disabled:d,children:d?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"me-2",children:"Verifying..."}),t.jsx(L,{strokeColor:"white",strokeWidth:"5",animationDuration:"0.75",width:"20",visible:!0})]}):"Verify OTP"})]})]})})}const $=j.memo(S);export{$ as default};
