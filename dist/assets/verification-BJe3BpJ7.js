import{r as g,j as t,R as j,F as I,f as w,u as E,E as N,s as x,G as B}from"./index-8kXOQ8MA.js";import{u as L,F as T}from"./index-B-HnDY6i.js";const S=({seconds:n=30,minutes:u=0,onResendClick:o,resendButtonText:d="Resend OTP",text:p="Time Left",style:f={},buttonStyle:h={}})=>{const[s,y]=g.useState(u*60+n),[i,l]=g.useState(!0);g.useEffect(()=>{let a;return i&&s>0?a=setInterval(()=>{y(s-1)},1e3):s===0&&l(!1),()=>clearInterval(a)},[i,s]);const b=async()=>{o&&await o()!==!1&&(y(u*60+n),l(!0))},m=()=>{const a=Math.floor(s/60),e=s%60;return`${a}:${e<10?"0":""}${e}`};return t.jsx("div",{style:f,children:i?t.jsxs("span",{children:[p," ",m()]}):t.jsx("button",{onClick:b,style:{background:"none",border:"none",color:"#e46a15",fontWeight:600,fontSize:"16px",cursor:"pointer",...h},children:d})})};function P(){const{register:n,handleSubmit:u,formState:{errors:o}}=L({mode:"onChange"}),[d,p]=g.useState(!1),f=I(),h=w(),{refetch:s}=E(),i=new URLSearchParams(f.search).get("email"),l=i?atob(i):null,b=async e=>{p(!0);let r=Object.values(e);r=r.join("");const v={email:l,otp:r};try{const c=await B(v);c.error?x(c.message,"error"):(f?.state?.type?(localStorage.setItem("token-bit-merchant",c.results.token),s()):h(`/reset-password?email=${btoa(l)}`),x(c.message,"success"))}catch{console.log("An error occurred")}finally{p(!1)}},m=(e,r,v,c)=>{e.keyCode!==9&&(e.key==="ArrowLeft"||e.key==="Backspace"?c?.focus():r?.value?.length>=r.maxLength&&v?.focus())},a=async()=>{const e={email:l};try{const r=await N(e);r.error?x(r.message,"error"):x(r.message,"success")}catch{console.log("An error occurred")}};return t.jsx("div",{className:"d-flex align-items-center justify-content-center vh-100",children:t.jsxs("div",{className:"card shadow p-4 border-0 login-card",children:[t.jsx("h3",{className:"text-center mb-3 text-main fw-bold",children:"Verify OTP"}),t.jsx("p",{className:"text-center text mb-4",children:"Enter the OTP Sent to Your Mobile Number."}),t.jsxs("form",{onSubmit:u(b),className:"text-center",children:[t.jsxs("div",{className:"d-flex justify-content-center mb-4",children:[t.jsx("input",{type:"number",maxLength:1,className:`form-control text-center mx-1 ${o.otp1?"input-error":""}`,style:{width:"50px",height:"50px"},...n("otp1",{required:!0}),onKeyUp:e=>{m(e,document.getElementById("otp1"),document.getElementById("otp2"))},onInput:e=>{e.target.value.length>1&&(e.target.value=e.target.value.slice(0,1))},id:"otp1"}),t.jsx("input",{type:"number",maxLength:1,className:`form-control text-center mx-1 ${o.otp2?"input-error":""}`,style:{width:"50px",height:"50px"},...n("otp2",{required:!0}),onKeyUp:e=>{m(e,document.getElementById("otp2"),document.getElementById("otp3"),document.getElementById("otp1"))},onInput:e=>{e.target.value.length>1&&(e.target.value=e.target.value.slice(0,1))},id:"otp2"}),t.jsx("input",{type:"number",maxLength:1,className:`form-control text-center mx-1 ${o.otp3?"input-error":""}`,style:{width:"50px",height:"50px"},...n("otp3",{required:!0}),onKeyUp:e=>{m(e,document.getElementById("otp3"),document.getElementById("otp4"),document.getElementById("otp2"))},onInput:e=>{e.target.value.length>1&&(e.target.value=e.target.value.slice(0,1))},id:"otp3"}),t.jsx("input",{type:"number",maxLength:1,className:`form-control text-center mx-1 ${o.otp4?"input-error":""}`,style:{width:"50px",height:"50px"},...n("otp4",{required:!0}),onKeyUp:e=>{m(e,document.getElementById("otp4"),document.getElementById("otp5"),document.getElementById("otp3"))},onInput:e=>{e.target.value.length>1&&(e.target.value=e.target.value.slice(0,1))},id:"otp4"})]}),t.jsx("div",{className:"mt-3 mb-3 text",children:t.jsx(S,{seconds:30,onResendClick:a,resendButtonText:"Resend OTP",text:"Time Left: ",style:{fontSize:"14px",textAlign:"center"}})}),t.jsx("button",{type:"submit",className:"btn w-100 comman-btn-main ",disabled:d,children:d?t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"me-2",children:"Verifying..."}),t.jsx(T,{strokeColor:"white",strokeWidth:"5",animationDuration:"0.75",width:"20",visible:!0})]}):"Verify OTP"})]})]})})}const A=j.memo(P);export{A as default};
